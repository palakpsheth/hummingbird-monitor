{% extends "base.html" %}
{% block content %}
  <h1>Individuals</h1>

  <div class="card">
    <form class="inline" method="get" action="/individuals">
      <label>Sort:</label>
      <select name="sort">
        <option value="visits" {% if sort == "visits" %}selected{% endif %}>Most visits</option>
        <option value="recent" {% if sort == "recent" %}selected{% endif %}>Most recent</option>
        <option value="id" {% if sort == "id" %}selected{% endif %}>ID</option>
      </select>

      <label style="margin-left:8px;">Limit:</label>
      <select name="limit">
        {% for n in [50, 100, 200, 500, 1000] %}
          <option value="{{ n }}" {% if limit == n %}selected{% endif %}>{{ n }}</option>
        {% endfor %}
      </select>

      <button type="submit">Apply</button>

      <span class="muted" style="margin-left:auto;">
        Total shown: {{ count_shown }}{% if count_total is not none %} / {{ count_total }}{% endif %}
      </span>
    </form>
  </div>

  <div class="card">
    <div class="table">
      <div class="row head">
        <div>ID</div><div>Name</div><div>Visits</div><div>Last seen (UTC)</div>
      </div>

      {% for ind in individuals %}
        {% set hue = (ind.id * 47) % 360 %}
        <div class="row">
          <div>{{ ind.id }}</div>
          <div>
            <a href="/individuals/{{ ind.id }}">
              <span class="badge ind-pill" style="--ind-hue: {{ hue }};">{{ ind.name }}</span>
            </a>
          </div>
          <div>{{ ind.visit_count }}</div>
          <div>{{ ind.last_seen_utc or "" }}</div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
